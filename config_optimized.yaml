# Input data configuration
input:
  dataframe_path: "/data-fast/data3/common/halo/original_models_data_gov/eec/eda_augmented_dataset/sample_5000_train_valid_test_from_combined.csv"
  text_column: "comment"

# Reference corpus configuration
reference:
  dataframe_path: "/data-fast/data3/common/halo/applications/data_from_data_gov/extraction_dg/all_data_gov_wo_qa.csv"
  text_column: "text"
  min_length: 50
  max_length: 1000

# LLM processor configuration
processor:
  gpu_list: [4,5,6,7]
  llm: "NEMO"
  gpu_memory_utilization: 0.9
  max_model_len: 8192
  multiplicity: 1

# Pipeline configuration
pipeline:
  batch_size: 25
  chunk_size: 10000
  prompt_batch_size: 2000

# Checkpointing configuration
checkpointing:
  save_frequency: 1

# Quality control
quality:
  min_semantic_similarity: 0.70
  enable_validation: false
  similarity_model: "sentence-transformers/all-mpnet-base-v2"

# Output configuration
output:
  output_folder: "/data-fast/data3/common/halo/original_models_data_gov/eec/eda_augmented_dataset/"
  save_intermediate: true

# =============================================================================
# AUGMENTATION ROUNDS
# =============================================================================
# Each operation can specify:
#   - type: augmentation type name
#   - backend: "llm" or "textattack" (optional - uses smart defaults)
#   - count: number of augmented versions per input
#   - params: backend-specific parameters
#
# DEFAULT BACKENDS (when not specified):
#   LLM: style_rewrite, paraphrase, sentence_restructure, formality_shift,
#        elaboration, compression
#   TextAttack: noise_injection, synonym_replace, homoglyph, typo,
#               morphological, entity_swap, composite
# =============================================================================

rounds:

  # Round 1: Deterministic noise (TextAttack - fast, no GPU needed for this)
  - name: "round_1_noise"
    apply_to: ["original"]
    operations:
      - type: "noise_injection"
        # backend: "textattack"  # This is the default, so optional
        count: 1
        params:
          transformations: ["qwerty", "char_delete", "char_swap"]
          pct_words_to_swap: 0.15
          transformations_per_example: 3
          constraints: "minimal"

      - type: "typo"
        count: 1
        params:
          pct_words_to_swap: 0.10
          transformations_per_example: 2

  # Round 2: Deterministic lexical variations (TextAttack)
  - name: "round_2_lexical"
    apply_to: ["original"]
    operations:
      - type: "synonym_replace"
        # backend: "textattack"  # Default
        count: 2
        params:
          pct_words_to_swap: 0.20
          transformations_per_example: 3
          constraints: "default"

      - type: "morphological"
        count: 1
        params:
          pct_words_to_swap: 0.15
          constraints: "default"

  # Round 3: Semantic transformations (LLM - requires understanding)
  - name: "round_3_semantic"
    apply_to: ["original"]
    operations:
      - type: "paraphrase"
        backend: "llm"  # Explicit, though it's the default
        count: 1

      - type: "sentence_restructure"
        backend: "llm"
        count: 1

  # Round 4: Style transfer (LLM only - no TextAttack equivalent)
  - name: "round_4_style"
    apply_to: ["original"]
    operations:
      - type: "style_rewrite"
        count: 1

      - type: "formality_shift"
        count: 1
        params:
          direction: "more casual"

  # Round 5: Adversarial robustness (TextAttack)
  - name: "round_5_adversarial"
    apply_to: ["round_3_semantic"]
    operations:
      - type: "homoglyph"
        count: 1
        params:
          pct_words_to_swap: 0.10

      - type: "entity_swap"
        count: 1
        params:
          entity_types: ["name", "number"]
          pct_words_to_swap: 0.30

  # Round 6: Compound (chain TextAttack on LLM outputs)
  - name: "round_6_compound"
    apply_to: ["round_4_style"]
    operations:
      - type: "noise_injection"
        count: 1
        params:
          transformations: ["qwerty", "char_swap"]
          pct_words_to_swap: 0.10

# =============================================================================
# TEXTATTACK PARAMETER REFERENCE
# =============================================================================
#
# TRANSFORMATIONS (for composite/noise_injection):
#   Character-level:
#     - qwerty: keyboard proximity typos
#     - char_delete: random character deletion
#     - char_insert: random character insertion
#     - char_substitute: random character replacement
#     - char_swap: adjacent character transposition
#     - homoglyph: visually similar unicode substitution
#   Word-level:
#     - wordnet: WordNet synonym replacement
#     - inflection: morphological variations
#     - contract: expand contractions (don't -> do not)
#     - extend: contract expansions (do not -> don't)
#     - change_name: swap named entities
#     - change_number: perturb numbers
#     - change_location: swap locations
#
# CONSTRAINTS:
#   - "default": RepeatModification + StopwordModification
#   - "strict": default + MinWordLength(4)
#   - "minimal": RepeatModification only
#   - "none": no constraints
#
# COMMON PARAMS:
#   - pct_words_to_swap: fraction of words to modify (0.0-1.0)
#   - transformations_per_example: number of transformation attempts
# =============================================================================
